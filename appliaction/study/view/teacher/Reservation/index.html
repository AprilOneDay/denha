<!DOCTYPE html>
<html>
    <head>
        <title>教师中心-预约一对一辅导</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="Content-Type" content="charset=utf-8" />
        <link href="/ststic/study/css/base.css" rel="stylesheet" type="text/css">
        <link href="/ststic/study/css/center.css" rel="stylesheet" type="text/css">
        <link href="/ststic/study/css/u_mob.css" rel="stylesheet" type="text/css"> 
        <link href="/ststic/study/css/mobiscroll_002.css" rel="stylesheet" type="text/css">
        <link href="/ststic/study/css/mobiscroll.css" rel="stylesheet" type="text/css">
        <link href="/ststic/study/css/u_mob.css" rel="stylesheet" type="text/css"> 
        <link href="/ststic/study/css/mobiscroll_003.css" rel="stylesheet" type="text/css">

        <script src="/ststic/study/js/jquery.min.js" type="text/javascript"></script>
        <script src="/ststic/study/js/mobiscroll_002.js" type="text/javascript"></script>
        <script src="/ststic/study/js/mobiscroll_004.js" type="text/javascript"></script>

        <script src="/ststic/study/js/mobiscroll.js" type="text/javascript"></script>
        <script src="/ststic/study/js/mobiscroll_003.js" type="text/javascript"></script>
        <script src="/ststic/study/js/mobiscroll_005.js" type="text/javascript"></script>
      
        <script src="/ststic/study/js/menu.js" type="text/javascript"></script>


        <script type="text/javascript" src="/ststic/study/js/common.js"></script>
        <script type="text/javascript" src="/vendor/layer/layer.js"></script>
    </head>
<body bgcolor="f1f1f1" >
    
        <div class="center">
            <header>
                <div id="navbar"><span><i class="ico2"></i>教师中心-课时管理</span><a href="javascript:;" class="menubtn"></a>
                    {include public/left_menus}
                </div>
            </header>
        
        <div class="classroom_right">
                <h3 class="my_news">预约信息</h3>
            <div class="t_cr_left fl">
             <p class="onli">课程分类</p>
                <ul class="clearfix div_ul2">
                    {loop $courseList $key $value}
                      <li {if $goodsid == $value['id']}class="on"{/if}><a href="{F:url('index',array('goodsid'=>$value['id']))}" >{$value['title']}</a></li>
                    {/loop}
                </ul>
            </div>



            <div class="t_cr_right fr yy_pp navgation">
                <ul class="fudao_ul clearfix">
                    {loop $list $value}
                    <li class="clearfix">
                        <div class="li_left">
                            <p class="title_names"><a href="javascript:;" class="name">{$value['goods']['title']} </a></p>
                            <p class="n_t_t"><b>【{$value['user']['real_name']}】</b>
                                <span>{F:date('Y-m-d',$value['start_time'])}<i></i>{F:date('H:i',$value['start_time'])}-{F:date('H:i',$value['end_time'])}</span>
                                {if $value['mobile']}
                                <span>电话：{$value['mobile']}</span>
                                {/if}
                            </p>
                            <p class="yuyue_c">{$value['user_msg']}</p>
                            {if $value['teacher_msg']}
                            <p class="yuyue_c">回复：{$value['teacher_msg']}</p>
                            {/if}
                        </div>
                        <div class="right_li">
                            {if $value['status'] == 0 }
                                <a class="xg_time" href="javascript:;" data-id="{$value['id']}">修改时间</a>
                            {elseif $value['status'] == 1}
                                <a class="yy_su" href="javascript:;">预约成功</a>
                            {elseif $value['status'] == 2}
                                <a class="xg_qr" href="javascript:;">等待学生同意</a>
                            {elseif $value['status'] == 3}
                                <a class="yy_su" href="javascript:;">老师拒绝</a>
                            {elseif $value['status'] == 4}
                                <a class="yy_su" href="javascript:;">学生拒绝修改时间</a>
                            {/if}

                            {if $value['status'] == 0 || ($value['status'] == 2 && $value['user_agree'] == 1)}
                                <a class="xg_qr btn-ajax-post" config-tips="同意后不可更改，确定同意预约？" config-href="{F:url('agree')}" data-id="{$value['id']}" href="javascript:;">同意预约</a>
                            {/if}

                            {if $value['status'] != 1 && $value['status'] != 3}
                                <a class="xg_qr btn-ajax-post" config-tips="拒绝后不可更改，确定拒绝本次预约？" config-href="{F:url('close')}" data-id="{$value['id']}" href="javascript:;">拒绝预约</a>
                            {/if}
                        </div>
                        {if !$value['teacher_msg']}
                        <p class="hf_btns"><input type="button" id="button" value="回复" /></p>
                        {/if}
                        <div class="div">
                            <span class="sj"></span>
                            <textarea name="" cols="" rows=""></textarea>
                            <a href="javascript:;"  class="hf_btn">回复</a>
                       </div>
                    </li>
                    {/loop}

                    {if $pages}
                    <div class="page ">
                        <p><b>{$pages['pageNo']}</b>/{$pages['allPage']}</p>
                        <a href="{$pages['pageUrl']}?pageNo={F:max($pages['pageNo'] - 1,1)}">上一页</a>
                        <a href="{$pages['pageUrl']}?pageNo={F:min($pages['pageNo'] + 1,$pages['allPage'])}">下一页</a>
                    </div>
                    {/if}
                </ul>
                
                
            </div>
        </div>
        </div>
        
        <div class="xiugai  clearfix">
            <form>
                <input type="hidden" value="" name="id">
                <div class="xiugai_box clearfix">
                    <div class="close"><a href="javascript:;" class="closebox"></a></div>
                    <b>修改预约时间</b>
                    <p><span>日期</span><input  placeholder="请选择"  type="text" name="tmp_time" id="appDate" class="form-control" value="2015-5-20"/></p>
                    <p><span>时间段</span> <input type="text" name="time_1" id="appTime" class="form-controls" value="9:00"/>
                    <input type="text" name="time_2" id="appTime2" class="form-controls " value="23:00"/>
                    </p>
                    <a class="btn_xg clearfix" href="javascript:;">确认修改</a>
                </div>
            </form>
        </div>  
</body>
<script>
    $(".xg_time").click(function(){
        $(".xiugai").slideToggle();
        $('input[name=id]').val($(this).attr('data-id'));
    })

  $(".closebox ").click(function(){
        $(".xiugai").css("display","none");
  })

    $('.btn_xg').click(function(){
        var tmp_time_1 = $('input[name=time_1]').val();
        var tmp_time_2 = $('input[name=time_2]').val();
        var tmp_time   = $('input[name=tmp_time]').val();
        
        if(!tmp_time){
            return layer.msg('请选择日期');
        }

        if(!tmp_time_1){
            return layer.msg('请选择开始时间');
        }

        if(!tmp_time_2){
           return layer.msg('请选择结束时间'); 
        }

        var startTime = tmp_time+' '+tmp_time_1;
        var endTime   = tmp_time+' '+tmp_time_2;
        var id        = $('input[name=id]').val();

        $.post("{F:url('change_time')}",{id:id,start_time:startTime,end_time:endTime},function(result){
            layer.msg(result.msg);
            if(result.status){
                setTimeout(function(){
                    window.location.href  = window.loaction;
                },1000);
            }
        },"json");

    })
</script>

<script type="text/javascript">
        $(function () {
            var currYear = (new Date()).getFullYear();  
            var opt={};
            opt.date = {preset : 'date'};
            opt.datetime = {preset : 'datetime'};
            opt.time = {preset : 'time'};
            opt.default = {
                theme: 'android-ics light', //皮肤样式
                display: 'modal', //显示方式 
                mode: 'scroller', //日期选择模式
                dateFormat: 'yyyy-mm-dd',
                lang: 'zh',
                showNow: true,
                nowText: "今天",
                startYear: currYear - 10, //开始年份
                endYear: currYear + 10 //结束年份
            };

            $("#appDate").mobiscroll($.extend(opt['date'], opt['default']));
            var optDateTime = $.extend(opt['datetime'], opt['default']);
            var optTime = $.extend(opt['time'], opt['default']);
            $("#appDateTime").mobiscroll(optDateTime).datetime(optDateTime);
            $("#appTime").mobiscroll(optTime).time(optTime);
            $("#appTime2").mobiscroll(optTime).time(optTime);
        });
    </script>
    <script type="text/javascript">
        $(document).ready(function () {
            $(".navgation input").each(function (i,value) {
                $(value).click(
                    function () { $(value).parent().next().slideToggle(); },
                    function () { $(value).parent().next().slideToggle(); }
                );
            });
        });
    </script>
    
                <script>
    $(document).ready(function(){
  $(".onli").click(function(){
  $(".t_cr_left ul").slideToggle();
  });
   });

    </script>
</html>
